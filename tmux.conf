set -g default-terminal 'xterm-256color'

# Plugins
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# tmux-resurrect config
set -g @resurrect-processes 'ssh'

# KeyBindings
unbind-key C-b
set -g prefix 'C-a'
bind-key 'c-a' send-prefix

# enable opt/ctrl+arrow to skip words
set-window-option -g xterm-keys on
# use vim key mode
set-window-option -g mode-keys vi
# use vim dir keys to switch panes
unbind-key h
unbind-key l
unbind-key j
unbind-key k
bind-key h select-pane -R
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -L
# use vim dir keys to switch windows
unbind-key H
bind-key H previous-window
unbind-key L
bind-key L next-window
# clear buffer
bind -n C-x send-keys C-l \; run-shell "sleep .3s" \; clear-history
# open panes and windows in current directory
unbind-key '"'
unbind-key c
unbind-key %
bind-key c new-window -c "#{pane_current_path}"
bind-key % split-window -h -c "#{pane_current_path}"
bind-key '"' split-window -v -c "#{pane_current_path}"

# MOUSE Support
set-option -g -q mouse on
bind-key -T root PPage if-shell -F "#{alternate_on}" "send-keys PPage" "copy-mode -e; send-keys PPage"
bind-key -t vi-copy PPage page-up
bind-key -t vi-copy NPage page-down
bind-key -T root WheelUpPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; copy-mode -e; send-keys -M"
bind-key -T root WheelDownPane if-shell -F -t = "#{alternate_on}" "send-keys -M" "select-pane -t =; send-keys -M"
bind-key -t vi-copy WheelUpPane halfpage-up
bind-key -t vi-copy WheelDownPane halfpage-down

# Copy-paste integration
set-option -g default-command "reattach-to-user-namespace -l bash"

# Use vim keybindings in copy mode
setw -g mode-keys vi

# Setup 'v' to begin selection as in Vim
unbind -t vi-copy v
unbind -t vi-copy y
bind-key -t vi-copy v begin-selection
bind-key -t vi-copy y copy-pipe "reattach-to-user-namespace pbcopy"

# Update default binding of `Enter` to also use copy-pipe
unbind -t vi-copy Enter
bind-key -t vi-copy Enter copy-pipe "reattach-to-user-namespace pbcopy"

# Bind ']' to use pbpaste
bind ] run "reattach-to-user-namespace pbpaste | tmux load-buffer - && tmux paste-buffer"

# Color status bar
set -g status-bg black
set -g status-fg white
set -g message-bg black
set -g message-fg white

# Init TPM SHOULD ALWAYS BE AT BOTTOM OF FILE
run '~/.tmux/plugins/tpm/tpm'
